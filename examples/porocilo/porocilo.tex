\documentclass[10pt,a4paper]{article}
\usepackage[utf8]{inputenc}
% \usepackage[T1]{fontenc}
\usepackage[slovene]{babel}

\usepackage{multirow}

\usepackage{amsmath}
% \usepackage{amsfonts}
% \usepackage{amssymb}

% \usepackage{graphics}
\usepackage{graphicx}

\usepackage{fp}
\usepackage{xstring}



\title{Poročilo odkrivanja 1-D ODE v Lorenzovemu sistemu}
\author{Boštjan Gec}

\begin{document}
	\maketitle
    
\newcommand{\eqiiIp}{ 6.50962591625742e-09  }

\newcommand{\round}[2][2]{\( \FPeval{ \p }{round(#2, #1)} \p \)}
\newcommand{\roundNonE}[3]{\( \FPeval{ \p }{round(#1 * 10^(#2), #3)} \p\cdot 10^{-#2} \)}
% \StrCut
% \StrCut⟨[*]⟩[⟨nunber⟩]{⟨string⟩}{⟨stringA⟩}{⟨macroA⟩}{⟨macroB⟩
\StrCut{\eqiiIp}{e}{\coefA}{\order}
\coefA = \order \\
p == \round{\coefA}
p == \round[4]{\coefA}
\newcommand{\roundNonE}[3][2]{\( \FPeval{ \p }{ 10^(#2), #3)} \p\cdot 10^{-#2} \)}
\\
\newcommand{\eqiIp}{0.0015054336000000002}
\newcommand{\eqiIpRound}{\round{\eqiIp}{3}{2}}
% \newcommand{\eqiiIp}{0.0015054336000000002}
% \newcommand{\eqiiIp}{ 6.50962591625742e-09  }
% \newcommand{\eqiiIpRound}{\round{\eqiiIp}{4}{2}}
\newcommand{\eqiiiIp}{0.0004094779392000001}
\newcommand{\eqiiiIpRound}{\round{\eqiiiIp}{4}{2}}
%  \newcommand{\eq2_long}{-10.0*x*z - 10.0*x - 2.28910354326151*y
% \( \FPeval{ \p }{round(\eqiIp * 10^3, 2)} \p\cdot 10^{-3} \)
% p = \round{\eqiiIp}{0}{2} for lambda
\( \FPeval{ \p }{ 10 * \eqiIp } \p = p\)

% \( \eqiiIp \)

% p = \round{\eqiIp}{3}{2} for lambda

% \( \FPeval{ \echo }{round(\eqiIp * 10^3, 10)} \echo lambda \)
% p = \eqiIp \\
% \[ \FPeval\echo{round(\eqiIp,6)} 
% p = \echo \]
% aftermath
% \newcommand{\result}{1.23456789}
%  \( \FPeval{ \echo }{round(\eqiIp, 10)} \echo lambda \)
% \[
% % \FPmul\result{2.343949595939494939}{7}
% % \FPclip\result\result
% \FPtrunc\ult\eqiIp{3}
% % \FPeval\result{round(root(2,sin(result + 2.5)),2)}
% result =  \ult
% \]

Odkrivanje 1-D ODE ena"cb sem poganjal na Lorenzovemu sistemu ena"cb:
$$
\frac{dx}{dt} = \sigma (y-x),
$$ $$
\frac{dy}{dt} = x(\rho-z) - y,
$$ $$
\frac{dz}{dt} = xy - \beta z,
$$
pri za"cetnih pogojih $x_0:=0.1, y_0:=0.3, z_0:=0.4$.
Za"cetni pogoji so isti v vseh primerih skozi celotno poro"cilo.
Parametri $\sigma, \rho$ in $\beta$ pa se sredi poro"cila
spremenijo. Najprej sem obravnaval nekaoti"cne parametre, nato 
pa "se znano kaoti"cne parametre z vrednostmi
$\sigma:=10, \rho:=28$ in $\beta:=8/3$.
Algoritem sem poganjal s pomo"cjo datoteke \verb|lorenz.py|, kjer sem ob poganjanju
ustrezno nastavil parametre in "stevilo vzorcev.

\subsection{Domnevno nekaoti"cni parametri}
Najprej sem algoritem pognal pri nekaoti"cnih subjektivno naklju"cno izbranih parametrih
$\sigma:=1.3, \rho:=-15$ in $\beta:=3.4$.
Navedeni izbrani parametri se na splo"sno smatrajo kot nenormalni, saj je vsaj eden izmed parametrov
($\rho$) nepozitiven.
% Podatkovno mno"zico sem generiral tako, da sem simuliral Lorenzov sistem:

Za prvo ena"cbo $\frac{dx}{dt} = \sigma \cdot(y-x)$, algoritem najde re"sitev 
$$\frac{dx}{dt} =  -1.3*x + 1.3*y$$ 
v 50 vzorcih, medtem ko ima re"sitev napako reda $10^{-9}$.

Za drugo ena"cbo 
$\frac{dy}{dt} = x(\rho-z) - y$,
algoritem najde re"sitev  \\
$\frac{dy}{dt} = -9.99969912689157*x*z - 9.99918437188885*x 
+ 0.0193086499353945*y - 1.09610736513107*z \\ 
\dot{=} -10*x*z -10*x +0.02*y -z $
\enspace oz. $$-10.0*x*z - 10.0*x - 2.28910354326151*y = 10*x*z -10*x +2*y$$ v 
4500 ali 6500 vzorcih, re"sitev ima pri tem napako 
reda velikosti $10^{-6}$ oz. $10^{-4}$. 

Tako velik odmik od prave re"sitve  
$-x*z-15*x-y$ pripisujem trenutno nastavljeni omejitvi v implementaciji optimizacijskega
algoritma, ki omejuje parametre na interval [-10, 10]. Parameter v "clenu $-10*x$ je tako
lahko po absolutni vrednosti najve"c 10, torej ne more biti -15, kot je v izvorni ena"cbi.
Predvidevam, da se zato zgodi kompenzacija nad ostalimi parametri v ostalih "clenih ena"cbe.
Predvidevam "se, da se bo pri rahljanju omejitve iz [-10, 10] na [-20, 20] napaka popravila
na napako reda $10^{-9}$ kot pri ostalih dveh ena"cbah.

Za tretjo ena"cbo 
$\frac{dz}{dt} = xy - \beta z$,
 algoritem najde re"sitev 
 $$\frac{dz}{dt} = 1.054*x*y - 3.402*z$$
v 100 vzorcih, medtem ko ima re"sitev napako velikosti 
$2.205\cdot 10^{-9}$, torej reda $10^{-9}$.

\subsection{Kaoti"cni rezultati}

Sledi poro"cilo o poganjanju pri kaoti"cnih parametrih:
$\sigma:=10, \rho:=28, \beta:=8/3$.

Ker je $\rho$ po absolutni vrednosti spet ve"cji od 10, tj. od nastavljenih 
mej za parametre optimizacijskega algoritma in so ostali dve vrednosti 
znotraj mej, predvidevamo da bodo v najbolj"sem primeru podobni rezultati kot 
v nekaoti"cnem primeru. Natan"cneje, pri drugi ena"cbi "spekuliramo
ena"cbo $10*x*z -10*x +7*y$.

V odkrivanju prve ena"cbe algoritem odkrije ena"cbo: 
$$\frac{dx}{dt} = -9.85764357227234*x + 9.9333747564978*y$$  
oz. $$\frac{dx}{dt} = -9.55829580188787*x + 9.78920618974904*y + 0.0232261285460231$$
v manj kot 50 vzorcih, medtem ko ima re"sitev napako velikosti
$2.94709382690573e-06$ oz. $2.4772067855792343e-06$, torej reda $10^{-6}$.

V odkrivanju druge ena"cbe algoritem odkrije ena"cbo:
$$ \frac{dy}{dt} = -0.670382396435091*x*z + 10.0*x + 6.94013313376156*y $$
oz. $$ \frac{dy}{dt} = -0.877950876789105*x*z + 9.99535400929563*x + 7.38550161602604*y - 0.617064542958862 $$ 
v 4500 oz. 6500 vzorcih, medtem ko ima ena"cba napako velikosti
$0.0033668325250160443 = 3.4\cdot 10^ {-3}$ oz. $0.00018803715641311185 = 1.9\cdot 10^ {-4}$.
Za primerjavo, je izmed vseh vzor"cenih ena"cb, najmanj"sa opa"zena napaka
reda $10^ {-5}$.

V odkrivanju tretje ena"cbe algoritem odkrije ena"cbo: 
$$\frac{dz}{dt} = 0.991337569095305*x*y - 2.56521319047224*z$$ 
v manj kot 100 vzorcih, medtem ko ima ena"cba napako velikosti
$9.178140365155879e-05 = 9.2\cdot 10^ {-5}$,
kar je v okviru najmanj"sega opa"zenega reda velikosti napake.

% verjetnosti:
% prva: 0.0015054336000000002
% druga:  6.50962591625742e-09
% tretja: 0.0004094779392000001
\pagebreak
\section{Poro"cilo v tabeli}

\begin{table}
	\begin{tabular}{cc *{15}{c}cccccccc}
		\multicolumn{1}{p{1cm}|}{tip ena"cbe oz. parametri} & 
		\multicolumn{1}{p{0.5cm}|}{leva stran ena"cbe} &
		 \multicolumn{1}{p{5cm}|}{najdena desna stran ena"cbe vs. izvorna ena"cba} &
		 \multicolumn{1}{p{1cm}|}{verjetnost ena"cbe} &
		  \multicolumn{1}{p{2cm}|}{napaka ena"cbe} &
		   \multicolumn{1}{p{1cm}|}{"stevilo potrebnih vzorcev} & 
		   \multicolumn{1}{p{1cm}|}{hramba rezultatov} & \multicolumn{1}{p{1cm}|}{top 1\%} \\
		   \hline
		\multirow{6}{1.5cm}{nekaoti"cna} & \multirow{2}{1.5cm}{$\frac{dx}{dt}$} & $ -1.303*x + 1.303*y $ & $\cdot 10^{-9}$ & 50 & &  \\
								 & & $ -1.3*x + 1.3*y $ & & & \\
								\cline{3-6}
		 & \multirow{2}{1.5cm}{$\frac{dy}{dt}$} & $-10.0*x*z - 10.0*x - 2.289*y$ & p = \( 1.3 \) & $8\cdot 10^{-4}$ & 100 &  \\
								 & & $ -x*z -15*x -y $ & & & \\
								\cline{3-6}
		& \multirow{2}{1.5cm}{$\frac{dz}{dt}$} & $1.054*x*y - 3.402*z$ & $2.205\cdot 10^{-9}$ & 6500 \\
								 & & $ x*y - 3.4*z $ & & & \\
		\hline
		\multirow{6}{1.5cm}{kaoti"cna} & \multirow{2}{1.5cm}{$\frac{dx}{dt}$} & $-9.857*x + 9.933*y$ & $2.947\cdot 10^{-6}$  & 50 \\
								 & & $ -10*x + 10*y $ & & & \\
								\cline{3-6}
		& \multirow{2}{1.5cm}{$\frac{dy}{dt}$} & $ -0.670*x*z + 10.0*x + 6.940*y $ & \round{\eqiIp}{3}{2} & $ 1.9\cdot 10^ {-4}$ & 100 \\
								 & & $ -x*z + 28*x -y $ & & & \\
								\cline{3-6}
		& \multirow{2}{1.5cm}{$\frac{dz}{dt}$} & $0.991*x*y - 2.565*z$ & \(\FPeval\p{ round(\eqiIp * 10^{3}, 2)} \p \cdot 10^{-3} \) & $9.2\cdot 10^ {-5}$ & 6500 \\
								 & & $ x*y - 2.66666*z $ & & & \\
	\end{tabular}
	 \caption{ Celotno poro"cilo je stisnjeno tudi v tej tabeli. }
\end{table}

%  \( \FPtrunc\p\eqiiIp{6} \p \) 


% \(\FPeval\p{1.2}\p\)
% \( \FPeval{ \p }{round(\eqiIp * 10^3, 2)} \p\cdot 10^{-3} \)
\round{\eqiIp}{3}{2}
\end{document}